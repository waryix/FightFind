<!DOCTYPE html>
<html>
<head>
    <title>Debug Logout - FightFind</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { margin: 10px; padding: 10px 20px; font-size: 16px; }
        #status { background: #f5f5f5; padding: 15px; margin: 15px 0; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>FightFind Logout Debug Tool</h1>
    
    <div id="status"></div>
    
    <button onclick="checkAuth()">Check Auth Status</button>
    <button onclick="clearAuth()">Clear Auth (Manual Logout)</button>
    <button onclick="setAuth()">Set Test Auth</button>
    <button onclick="goToApp()">Go to Main App</button>
    
    <script>
        function checkAuth() {
            const user = localStorage.getItem('user');
            const isAuth = localStorage.getItem('isAuthenticated');
            const allKeys = Object.keys(localStorage);
            
            document.getElementById('status').innerHTML = `
                <h3>Current Auth Status:</h3>
                <p><strong>isAuthenticated:</strong> <span class="${isAuth === 'true' ? 'success' : 'error'}">${isAuth || 'null'}</span></p>
                <p><strong>user:</strong> ${user ? '<span class="success">Present</span>' : '<span class="error">null</span>'}</p>
                <p><strong>user data:</strong> ${user || 'none'}</p>
                <p><strong>All localStorage keys:</strong> ${allKeys.length > 0 ? allKeys.join(', ') : 'none'}</p>
                <p><strong>Status:</strong> ${isAuth === 'true' ? '<span class="success">LOGGED IN</span>' : '<span class="error">LOGGED OUT</span>'}</p>
            `;
        }
        
        function clearAuth() {
            // Clear specific auth items
            localStorage.removeItem('user');
            localStorage.removeItem('isAuthenticated');
            
            // Clear everything to be absolutely sure
            localStorage.clear();
            
            // Trigger storage event for app components
            window.dispatchEvent(new StorageEvent('storage', {
                key: 'isAuthenticated',
                oldValue: 'true',
                newValue: null,
                storageArea: localStorage
            }));
            
            alert('✅ Authentication cleared successfully!\\n\\nGo back to the main app and refresh - you should now be logged out.');
            checkAuth();
        }
        
        function setAuth() {
            const testUser = {
                id: 'test_' + Date.now(),
                firstName: 'Debug',
                lastName: 'User',
                email: 'debug@fightfind.com',
                createdAt: new Date().toISOString()
            };
            
            localStorage.setItem('user', JSON.stringify(testUser));
            localStorage.setItem('isAuthenticated', 'true');
            
            // Trigger storage event
            window.dispatchEvent(new StorageEvent('storage', {
                key: 'isAuthenticated',
                oldValue: null,
                newValue: 'true',
                storageArea: localStorage
            }));
            
            alert('✅ Test authentication set!\\n\\nGo back to the main app and refresh - you should now be logged in as Debug User.');
            checkAuth();
        }
        
        function goToApp() {
            window.location.href = '/';
        }
        
        // Check auth status on page load
        window.onload = function() {
            checkAuth();
        };
    </script>
</body>
</html>
